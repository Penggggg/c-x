"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var MAX_PAGES = 9;
var whiteList = [];
var makeQuery = function (url) {
    var params = {};
    var path = url.split('?')[1];
    if (!path) {
        return params;
    }
    var paramsArr = path.split('&');
    paramsArr.map(function (paramsSet) {
        var _a;
        params = Object.assign({}, params, (_a = {},
            _a[paramsSet.split('=')[0]] = paramsSet.split('=')[1],
            _a));
    });
    return params;
};
var judgeEqual = function (obj1, obj2) {
    var key1 = Object.keys(obj1);
    var key2 = Object.keys(obj2);
    if (key1.length !== key2.length) {
        return;
    }
    return !key1.some(function (keyx1) { return obj1[keyx1] !== obj2[keyx1]; });
};
exports.navTo = function (url) {
    var pages = getCurrentPages();
    var pageLen = pages.length;
    var params = makeQuery(url);
    var existedTarget = pages.find(function (x) { return "/" + x.route === url.split('?')[0]; });
    var existedIndex = pages.findIndex(function (x) { return "/" + x.route === url.split('?')[0]; });
    console.log('???', pages);
    if (!!existedTarget) {
        var isParamEqual = judgeEqual(params, existedTarget.options);
        if (isParamEqual || whiteList.findIndex(function (x) { return x === url.split('?')[0]; }) !== -1) {
            wx.navigateBack({
                delta: pageLen - existedIndex - 1
            });
        }
        else {
            if (pageLen < MAX_PAGES) {
                wx.navigateTo({
                    url: url
                });
            }
            else {
                wx.redirectTo({
                    url: url
                });
            }
        }
    }
    else {
        if (pageLen < MAX_PAGES) {
            wx.navigateTo({
                url: url
            });
        }
        else {
            wx.redirectTo({
                url: url
            });
        }
    }
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicm91dGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJyb3V0ZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLElBQU0sU0FBUyxHQUFHLENBQUMsQ0FBQztBQUdwQixJQUFNLFNBQVMsR0FBYyxFQUU1QixDQUFDO0FBR0YsSUFBTSxTQUFTLEdBQUcsVUFBRSxHQUFXO0lBQzNCLElBQUksTUFBTSxHQUFHLEVBQUcsQ0FBQztJQUNqQixJQUFNLElBQUksR0FBRyxHQUFHLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFFLENBQUMsQ0FBRSxDQUFDO0lBRWpDLElBQUssQ0FBQyxJQUFJLEVBQUc7UUFDVCxPQUFPLE1BQU0sQ0FBQztLQUNqQjtJQUVELElBQU0sU0FBUyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDbEMsU0FBUyxDQUFDLEdBQUcsQ0FBRSxVQUFBLFNBQVM7O1FBQ3BCLE1BQU0sR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLEVBQUcsRUFBRSxNQUFNO1lBQzlCLEdBQUUsU0FBUyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBRSxDQUFDLENBQUUsSUFBSSxTQUFTLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFFLENBQUMsQ0FBRTtnQkFDMUQsQ0FBQTtJQUNOLENBQUMsQ0FBQyxDQUFDO0lBQ0gsT0FBTyxNQUFNLENBQUM7QUFDbEIsQ0FBQyxDQUFDO0FBTUYsSUFBTSxVQUFVLEdBQUcsVUFBRSxJQUFZLEVBQUUsSUFBWTtJQUMzQyxJQUFNLElBQUksR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFFLElBQUksQ0FBRSxDQUFDO0lBQ2pDLElBQU0sSUFBSSxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUUsSUFBSSxDQUFFLENBQUM7SUFDakMsSUFBSyxJQUFJLENBQUMsTUFBTSxLQUFLLElBQUksQ0FBQyxNQUFNLEVBQUc7UUFBRSxPQUFPO0tBQUU7SUFDOUMsT0FBTyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUUsVUFBQSxLQUFLLElBQUksT0FBQyxJQUFZLENBQUUsS0FBSyxDQUFFLEtBQU0sSUFBWSxDQUFFLEtBQUssQ0FBRSxFQUFqRCxDQUFpRCxDQUFDLENBQUM7QUFDbkYsQ0FBQyxDQUFDO0FBT1csUUFBQSxLQUFLLEdBQUcsVUFBRSxHQUFXO0lBRTFCLElBQU0sS0FBSyxHQUFHLGVBQWUsRUFBRyxDQUFDO0lBQ2pDLElBQU0sT0FBTyxHQUFHLEtBQUssQ0FBQyxNQUFNLENBQUM7SUFDN0IsSUFBTSxNQUFNLEdBQUcsU0FBUyxDQUFFLEdBQUcsQ0FBRSxDQUFDO0lBQ2hDLElBQU0sYUFBYSxHQUFRLEtBQUssQ0FBQyxJQUFJLENBQUUsVUFBQSxDQUFDLElBQUksT0FBQSxNQUFJLENBQUMsQ0FBQyxLQUFPLEtBQUssR0FBRyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBRSxDQUFDLENBQUUsRUFBckMsQ0FBcUMsQ0FBQyxDQUFDO0lBQ25GLElBQU0sWUFBWSxHQUFHLEtBQUssQ0FBQyxTQUFTLENBQUUsVUFBQSxDQUFDLElBQUksT0FBQSxNQUFJLENBQUMsQ0FBQyxLQUFPLEtBQUssR0FBRyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBRSxDQUFDLENBQUUsRUFBckMsQ0FBcUMsQ0FBQyxDQUFDO0lBQ2xGLE9BQU8sQ0FBQyxHQUFHLENBQUUsS0FBSyxFQUFFLEtBQUssQ0FBRSxDQUFBO0lBRTNCLElBQUssQ0FBQyxDQUFDLGFBQWEsRUFBRztRQUVuQixJQUFNLFlBQVksR0FBRyxVQUFVLENBQUUsTUFBTSxFQUFFLGFBQWEsQ0FBQyxPQUFPLENBQUUsQ0FBQztRQUVqRSxJQUFLLFlBQVksSUFBSSxTQUFTLENBQUMsU0FBUyxDQUFFLFVBQUEsQ0FBQyxJQUFJLE9BQUEsQ0FBQyxLQUFLLEdBQUcsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUUsQ0FBQyxDQUFFLEVBQXpCLENBQXlCLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRztZQUcvRSxFQUFFLENBQUMsWUFBWSxDQUFDO2dCQUNaLEtBQUssRUFBRSxPQUFPLEdBQUcsWUFBWSxHQUFHLENBQUM7YUFDcEMsQ0FBQyxDQUFDO1NBR047YUFBTTtZQUdILElBQUssT0FBTyxHQUFHLFNBQVMsRUFBRztnQkFDdkIsRUFBRSxDQUFDLFVBQVUsQ0FBQztvQkFDVixHQUFHLEtBQUE7aUJBQ04sQ0FBQyxDQUFDO2FBR047aUJBQU07Z0JBQ0gsRUFBRSxDQUFDLFVBQVUsQ0FBQztvQkFDVixHQUFHLEtBQUE7aUJBQ04sQ0FBQyxDQUFDO2FBQ047U0FDSjtLQUVKO1NBQU07UUFHSCxJQUFLLE9BQU8sR0FBRyxTQUFTLEVBQUc7WUFDdkIsRUFBRSxDQUFDLFVBQVUsQ0FBQztnQkFDVixHQUFHLEtBQUE7YUFDTixDQUFDLENBQUM7U0FHTjthQUFNO1lBQ0gsRUFBRSxDQUFDLFVBQVUsQ0FBQztnQkFDVixHQUFHLEtBQUE7YUFDTixDQUFDLENBQUM7U0FDTjtLQUNKO0FBQ1QsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgTUFYX1BBR0VTID0gOTtcblxuLyoqIOWMuemFjeWIsHVybO+8jOS9huaYr+S4jeeUqOWMuemFjXF1ZXJ5ICovXG5jb25zdCB3aGl0ZUxpc3Q6IHN0cmluZ1sgXSA9IFtcbiAgIFxuXTtcblxuLyoqIOagueaNrnVybCDov5Tlm55wYXJhbeWvueixoSAqL1xuY29uc3QgbWFrZVF1ZXJ5ID0gKCB1cmw6IHN0cmluZyApID0+IHtcbiAgICBsZXQgcGFyYW1zID0geyB9O1xuICAgIGNvbnN0IHBhdGggPSB1cmwuc3BsaXQoJz8nKVsgMSBdO1xuXG4gICAgaWYgKCAhcGF0aCApIHtcbiAgICAgICAgcmV0dXJuIHBhcmFtcztcbiAgICB9XG5cbiAgICBjb25zdCBwYXJhbXNBcnIgPSBwYXRoLnNwbGl0KCcmJyk7XG4gICAgcGFyYW1zQXJyLm1hcCggcGFyYW1zU2V0ID0+IHtcbiAgICAgICAgcGFyYW1zID0gT2JqZWN0LmFzc2lnbih7IH0sIHBhcmFtcywge1xuICAgICAgICAgICAgWyBwYXJhbXNTZXQuc3BsaXQoJz0nKVsgMCBdXTogIHBhcmFtc1NldC5zcGxpdCgnPScpWyAxIF1cbiAgICAgICAgfSlcbiAgICB9KTtcbiAgICByZXR1cm4gcGFyYW1zO1xufTtcblxuLyoqIFxuICogISDmraTlh73mlbDmnInmvI/mtJ5cbiAqIOWIpOaWreS4pOS4qnBhcmFtc+WvueixoeaYr+WQpuebuOetiVxuICovXG5jb25zdCBqdWRnZUVxdWFsID0gKCBvYmoxOiBvYmplY3QsIG9iajI6IG9iamVjdCApID0+IHtcbiAgICBjb25zdCBrZXkxID0gT2JqZWN0LmtleXMoIG9iajEgKTtcbiAgICBjb25zdCBrZXkyID0gT2JqZWN0LmtleXMoIG9iajIgKTtcbiAgICBpZiAoIGtleTEubGVuZ3RoICE9PSBrZXkyLmxlbmd0aCApIHsgcmV0dXJuOyB9XG4gICAgcmV0dXJuICFrZXkxLnNvbWUoIGtleXgxID0+IChvYmoxIGFzIGFueSlbIGtleXgxIF0gIT09IChvYmoyIGFzIGFueSlbIGtleXgxIF0pO1xufTtcblxuLyoqXG4gKiBcbiAqIOi/nue7rTLkuKrnm7jlkIx1cmzvvIzkuI3lkIxxdWVyee+8jFxuICogQSAtPiBCIOeahOaXtuWAme+8jHF1ZXJ55Y+C5pWw5Y+v6IO95pyJ6Zeu6aKYXG4gKi9cbmV4cG9ydCBjb25zdCBuYXZUbyA9ICggdXJsOiBzdHJpbmcgKSA9PiB7XG5cbiAgICAgICAgY29uc3QgcGFnZXMgPSBnZXRDdXJyZW50UGFnZXMoICk7XG4gICAgICAgIGNvbnN0IHBhZ2VMZW4gPSBwYWdlcy5sZW5ndGg7XG4gICAgICAgIGNvbnN0IHBhcmFtcyA9IG1ha2VRdWVyeSggdXJsICk7XG4gICAgICAgIGNvbnN0IGV4aXN0ZWRUYXJnZXQ6IGFueSA9IHBhZ2VzLmZpbmQoIHggPT4gYC8ke3gucm91dGV9YCA9PT0gdXJsLnNwbGl0KCc/JylbIDAgXSk7XG4gICAgICAgIGNvbnN0IGV4aXN0ZWRJbmRleCA9IHBhZ2VzLmZpbmRJbmRleCggeCA9PiBgLyR7eC5yb3V0ZX1gID09PSB1cmwuc3BsaXQoJz8nKVsgMCBdKTtcbiAgICAgICAgY29uc29sZS5sb2coICc/Pz8nLCBwYWdlcyApXG4gICAgICAgIC8vIOWmguaenOaJvuWIsOWOhuWPsui3r+eUsVxuICAgICAgICBpZiAoICEhZXhpc3RlZFRhcmdldCApIHtcblxuICAgICAgICAgICAgY29uc3QgaXNQYXJhbUVxdWFsID0ganVkZ2VFcXVhbCggcGFyYW1zLCBleGlzdGVkVGFyZ2V0Lm9wdGlvbnMgKTtcblxuICAgICAgICAgICAgaWYgKCBpc1BhcmFtRXF1YWwgfHwgd2hpdGVMaXN0LmZpbmRJbmRleCggeCA9PiB4ID09PSB1cmwuc3BsaXQoJz8nKVsgMCBdKSAhPT0gLTEgKSB7XG5cbiAgICAgICAgICAgICAgICAvLyDlj4LmlbDljLnphY3miJbogIXlrZjlnKjnmb3lkI3ljZXnmoTmg4XlhrXkuIvvvIznq4vpqazov5Tlm55cbiAgICAgICAgICAgICAgICB3eC5uYXZpZ2F0ZUJhY2soe1xuICAgICAgICAgICAgICAgICAgICBkZWx0YTogcGFnZUxlbiAtIGV4aXN0ZWRJbmRleCAtIDFcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gdXJs5Yy56YWN77yM5L2G5piv5Y+C5pWw5LiN5Yy56YWNXG4gICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgLy8g5om+5LiN5Yiw77yM5LiU5LiN6LaF6L+HbWF4XG4gICAgICAgICAgICAgICAgaWYgKCBwYWdlTGVuIDwgTUFYX1BBR0VTICkge1xuICAgICAgICAgICAgICAgICAgICB3eC5uYXZpZ2F0ZVRvKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybFxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vIOaJvuS4jeWIsO+8jOS4lOi2hei/h+S6hm1heFxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHd4LnJlZGlyZWN0VG8oe1xuICAgICAgICAgICAgICAgICAgICAgICAgdXJsXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAvLyDmib7kuI3liLDvvIzkuJTkuI3otoXov4dtYXhcbiAgICAgICAgICAgIGlmICggcGFnZUxlbiA8IE1BWF9QQUdFUyApIHtcbiAgICAgICAgICAgICAgICB3eC5uYXZpZ2F0ZVRvKHtcbiAgICAgICAgICAgICAgICAgICAgdXJsXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIOaJvuS4jeWIsO+8jOS4lOi2hei/h+S6hm1heFxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB3eC5yZWRpcmVjdFRvKHtcbiAgICAgICAgICAgICAgICAgICAgdXJsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbn07Il19