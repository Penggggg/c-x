!function(e){function t(t){for(var r,o,i=t[0],u=t[1],c=t[2],f=0,d=[];f<i.length;f++)o=i[f],Object.prototype.hasOwnProperty.call(l,o)&&l[o]&&d.push(l[o][0]),l[o]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);for(s&&s(t);d.length;)d.shift()();return a.push.apply(a,c||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,i=1;i<n.length;i++){var u=n[i];0!==l[u]&&(r=!1)}r&&(a.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},l={0:0},a=[];function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/dist/build";var i=window.webpackJsonp=window.webpackJsonp||[],u=i.push.bind(i);i.push=t,i=i.slice();for(var c=0;c<i.length;c++)t(i[c]);var s=u;a.push([462,1]),n()}({112:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=r(n(0));n(889),t.PtrConfTitle=function(e){var t=e.title;return l.default.createElement("div",{className:"com-ptr-conf-title"},t)}},191:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(60);t.DIC={nlp:{operator:{input:[{value:"==",label:"等于"},{value:"!=",label:"不等于"},{value:"contain",label:"包含"},{value:"not contain",label:"不包含"}],intent:[{value:"exist",label:"存在"},{value:"not exist",label:"不存在"}],slot:[{value:"==",label:"等于"},{value:"!=",label:"不等于"},{value:"exist",label:"存在"},{value:"not exist",label:"不存在"}],variable:[{value:"==",label:"等于"},{value:"!=",label:"不等于"},{value:">",label:"大于"},{value:"<",label:"小于"},{value:">=",label:"大于等于"},{value:"<=",label:"小于等于"}]},compareRange:[{value:"input",label:"用户话术中的关键词"},{value:"intent",label:"当轮对话中的意图"},{value:"slot",label:"当轮对话中的词槽"},{value:"variable",label:"全局变量"}],if:{input:[{label:"用户输入的文本内容",value:"user-input"}]},form:{required:[{label:"是",value:1},{label:"否",value:0}],fieldType:[{label:"字符串",value:"string"},{label:"数字",value:"float"}],sayMode:[{label:"按顺序",value:"sequential"},{label:"随机",value:"random"}],paramPos:[{label:"头部 header",value:"header"},{label:"请求体 body",value:"body"},{label:"查询串 query",value:"query"}],paramType:[{label:"自定义",value:"custom"},{label:"指定槽位",value:"slot"}]}}};var l=r.generateDic(t.DIC),a=l.findDicCN,o=l.findDic;t.findDicCN=a,t.findDic=o},192:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(l,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function i(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?l(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}u((r=r.apply(e,t||[])).next())}))},l=this&&this.__generator||function(e,t){var n,r,l,a,o={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(a){return function(i){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(l=2&a[0]?r.return:a[0]?r.throw||((l=r.return)&&l.call(r),0):r.next)&&!(l=l.call(r,a[1])).done)return l;switch(r=0,l&&(a=[2&a[0],l.value]),a[0]){case 0:case 1:l=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(l=(l=o.trys).length>0&&l[l.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!l||a[1]>l[0]&&a[1]<l[3])){o.label=a[1];break}if(6===a[0]&&o.label<l[1]){o.label=l[1],l=a;break}if(l&&o.label<l[2]){o.label=l[2],o.ops.push(a);break}l[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=l=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,i])}}},a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var o=n(21),i=n(55),u=a(n(0));n(895);var c={text:"文本",image:"图片",pause:"暂停",option:"选项",rich_text:"富文本",search_skill:"意图跳转"};t.PtrCustomAnswer=u.default.forwardRef((function(e,t){var n=e.types,a=void 0===n?[]:n,s=e.label,f=void 0===s?"":s,d=u.useState(null),p=d[0],m=d[1],h=u.useState(""),v=h[0],y=h[1],b=u.useState(""),g=b[0],_=b[1],k=u.useState(""),w=k[0],E=k[1],j=u.useState({}),x=j[0],P=j[1],O=u.useState(""),S=O[0],M=O[1],C=u.useState(0),N=C[0],T=C[1],I=u.useState(""),D=I[0],R=I[1];u.useImperativeHandle(t,(function(){return{getData:function(){return r(void 0,void 0,void 0,(function(){var e;return l(this,(function(t){var n;return(e=!(n=p)||("text"===n?!!v.trim():"rich_text"===n?!!g.trim():"image"===n?!!w.trim():"option"===n?Object.keys(x).length>0:"pause"!==n||!!D.trim()&&!!N))||o.message.error("请正确输入"),[2,{err:!e,data:"text"===p?{text:v}:"rich_text"===p?{text:g}:"image"===p?{title:"",url:w,description:""}:"option"===p?{title:"",description:S,my_option:x}:"pause"===p?{duration:N,tips:D}:null}]}))}))}}}));var q=u.useMemo((function(){return a.map((function(e){return{value:e,label:c[e]}}))}),[a]);return u.useEffect((function(){a[0]&&m(a[0])}),[a]),u.default.createElement("div",{className:"con-nlp-ptr-custom-answer"},u.default.createElement("div",null,u.default.createElement("span",null,f),u.default.createElement(o.Radio.Group,{buttonStyle:"solid",className:"opt-block",value:p,onChange:function(e){return m(e.target.value)}},q.map((function(e,t){return u.default.createElement(o.Radio.Button,{key:t,value:e.value},e.label)})))),"text"===p&&u.default.createElement(o.Input.TextArea,{rows:4,value:v,placeholder:"请输入文本信息",onChange:function(e){return y(e.target.value)}}),"rich_text"===p&&u.default.createElement(i.RichText,{placeholder:"请输入...",onChange:_,defaultValue:g,uploadUrl:"/apis/common/object-upload"}),"image"===p&&u.default.createElement(o.Input,{value:w,placeholder:"请输入图片url",onChange:function(e){return E(e.target.value)}}),"option"===p&&u.default.createElement("div",null,u.default.createElement(o.Input,{value:S,placeholder:"选项标题",onChange:function(e){return M(e.target.value)},style:{marginBottom:10}}),u.default.createElement(i.MulvalueActiveForm,{showEmpty:!0,json:x,onChane:P,placeholder:{key:"请输入选项的描述",value:"请输入选项的值（英文或数字）"}})),"pause"===p&&u.default.createElement("div",{className:"pause-block"},u.default.createElement(o.Input,{value:D,placeholder:"暂停时提示文案",onChange:function(e){return R(e.target.value)}}),u.default.createElement(o.InputNumber,{value:N,placeholder:"毫秒",style:{marginLeft:15},onChange:function(e){return T(e||0)}})))}))},414:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(801);t.AppHeader=r.AppHeader;var l=n(424);t.NlpProcess=l.NlpProcess;var a=n(436);t.NlpPtrStart=a.NlpPtrStart;var o=n(903);t.NlpTopicTree=o.NlpTopicTree},423:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=n(824),a=r(n(825)),o=l.createStore({User:a.default}),i=o.useStore,u=o.StoreProvider;t.useStore=i,t.StoreProvider=u},424:function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var l,a=r(n(0)),o=n(55),i=n(888),u=n(893),c=n(436),s=n(900);n(901),t.NlpProcess=function(e){var t=e.points,n=void 0===t?[]:t,r=e.relations,f=void 0===r?[]:r,d=e.abilityId,p=void 0===d?"":d,m=a.useRef(null),h=function(e){return e===l.collection?a.default.createElement(i.NlpPtrSlot,{abilityId:p}):e===l.answer?a.default.createElement(s.NlpPtrRes,{abilityId:p}):e===l.fetch?a.default.createElement(u.NlpPtrFetch,{abilityId:p}):a.default.createElement(c.NlpPtrStart,null)},v=function(e){return e===l.collection?a.default.createElement("div",{className:"com-nlp-process-ctrl"},a.default.createElement("div",{className:"ball purple"}),"词槽收集"):e===l.fetch?a.default.createElement("div",{className:"com-nlp-process-ctrl"},a.default.createElement("div",{className:"ball blue"}),"资源调用"):e===l.answer?a.default.createElement("div",{className:"com-nlp-process-ctrl"},a.default.createElement("div",{className:"ball cyan"}),"回复"):a.default.createElement("div",null)},y=function(e){return e===l.collection?"#ffadd2":e===l.answer?"#87e8de":e===l.fetch?"#91d5ff":"#ffadd2"},b=a.useMemo((function(){var e=n.map((function(e,t){return{id:e.id,x:100*t+100,y:100*t+100,ele:h(e.type),color:y(e.type),showLinkPtr:e.type!==l.start,showDelete:e.type!==l.start}}));return n.find((function(e){return e.type===l.start}))||e.unshift({y:10,x:250,id:"start",showLinkPtr:!1,showDelete:!1,ele:h(l.start)}),e}),[n]);return a.default.createElement(o.DragPanel,{ref:m,points:b,relations:f,ctrls:[{id:l.collection,ele:v(l.collection)},{id:l.fetch,ele:v(l.fetch)},{id:l.answer,ele:v(l.answer)}],onPtrAdd:function(e,t){t(h(e),y(e))}})},function(e){e[e.collection=0]="collection",e[e.fetch=1]="fetch",e[e.answer=2]="answer",e[e.start=3]="start"}(l||(l={}))},436:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(l,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function i(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?l(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}u((r=r.apply(e,t||[])).next())}))},l=this&&this.__generator||function(e,t){var n,r,l,a,o={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(a){return function(i){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(l=2&a[0]?r.return:a[0]?r.throw||((l=r.return)&&l.call(r),0):r.next)&&!(l=l.call(r,a[1])).done)return l;switch(r=0,l&&(a=[2&a[0],l.value]),a[0]){case 0:case 1:l=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(l=(l=o.trys).length>0&&l[l.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!l||a[1]>l[0]&&a[1]<l[3])){o.label=a[1];break}if(6===a[0]&&o.label<l[1]){o.label=l[1],l=a;break}if(l&&o.label<l[2]){o.label=l[2],o.ops.push(a);break}l[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=l=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,i])}}},a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var o=n(21),i=a(n(0)),u=n(192),c=n(437),s=n(112);t.NlpPtrStart=i.default.forwardRef((function(e,t){var n=i.useRef(null),a=i.useRef(null),f=i.useState(!1),d=f[0],p=f[1],m=function(){return r(void 0,void 0,void 0,(function(){var e,t;return l(this,(function(r){switch(r.label){case 0:return[4,n.current.getData()];case 1:return e=r.sent(),[4,a.current.getData()];case 2:return t=r.sent(),[2,{err:e.err||t.err,data:{rules:e,defaultRes:t}}]}}))}))};return i.useImperativeHandle(t,(function(){return{getData:function(){return r(void 0,void 0,void 0,(function(){return l(this,(function(e){switch(e.label){case 0:return[4,m()];case 1:return[2,e.sent()]}}))}))}}})),i.default.createElement("div",{className:"con-nlp-ptr-start"},i.default.createElement(o.Button,{icon:"bulb",type:"primary",onClick:function(){return p(!0)}},"开始"),i.default.createElement(o.Drawer,{width:450,visible:d,title:"配置 - 开始节点",onClose:function(){return p(!1)}},i.default.createElement(s.PtrConfTitle,{title:"规则配置"}),i.default.createElement(c.NlpPtrConditionRel,{ref:n}),i.default.createElement(s.PtrConfTitle,{title:"默认回复"}),i.default.createElement(u.PtrCustomAnswer,{label:"默认回复：",types:["text"],ref:a}),i.default.createElement(o.Button,{block:!0,type:"primary",style:{marginTop:50},onClick:function(){return r(void 0,void 0,void 0,(function(){var e;return l(this,(function(t){switch(t.label){case 0:return[4,m()];case 1:return e=t.sent(),e.err,e.data,[2]}}))}))}},"确定")))}))},437:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var l in t=arguments[n])Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l]);return e}).apply(this,arguments)},l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(l,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function i(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?l(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}u((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,l,a,o={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(a){return function(i){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(l=2&a[0]?r.return:a[0]?r.throw||((l=r.return)&&l.call(r),0):r.next)&&!(l=l.call(r,a[1])).done)return l;switch(r=0,l&&(a=[2&a[0],l.value]),a[0]){case 0:case 1:l=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(l=(l=o.trys).length>0&&l[l.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!l||a[1]>l[0]&&a[1]<l[3])){o.label=a[1];break}if(6===a[0]&&o.label<l[1]){o.label=l[1],l=a;break}if(l&&o.label<l[2]){o.label=l[2],o.ops.push(a);break}l[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=l=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,i])}}},o=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),l=0;for(t=0;t<n;t++)for(var a=arguments[t],o=0,i=a.length;o<i;o++,l++)r[l]=a[o];return r},i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var u=n(21),c=i(n(0)),s=n(897);n(898);var f={and:{value:"&&",label:"并且"},or:{value:"||",label:"或者"}};t.NlpPtrConditionRel=c.default.forwardRef((function(e,t){var n=e.abilityId,i=void 0===n?"":n,d=c.useState([{type:"module",children:[{type:"meta"}]}]),p=d[0],m=d[1],h=function(e){var t={type:"operate",val:e},n={type:"module",children:[{type:"meta"}]},r=[];r=0===p.length?[n]:[t,n],m(o(p,r))},v=function(e,t){var n=o(p),l=n[e].children||[],a={type:"operate",val:t},i={type:"meta"},u=[];u=0===l.length?[i]:[a,i],l=o(l,u),n.splice(e,1,r(r({},n[e]),{children:l})),m(n)},y=c.useMemo((function(){return p.map((function(e){var t=[];return"module"===e.type&&(t=(e.children||[]).map((function(e){return"meta"===e.type?c.createRef():null}))),t}))}),[p]);return c.useImperativeHandle(t,(function(){return{getData:function(){return l(void 0,void 0,void 0,(function(){var e,t,n,r,l;return a(this,(function(a){switch(a.label){case 0:return[4,Promise.all(y.map((function(e){return Promise.all(e.filter((function(e){return!!e})).map((function(e){return e.current.getData()})))})))];case 1:return e=a.sent(),t=e.map((function(e){return e.map((function(e){return e.data}))})),n=e.some((function(e){return e.some((function(e){return!!e.err}))})),r=function(e){var t=p[e].children||[];return t.length<=2?"":f[t.find((function(e){return"operate"===e.type})).val].value},l={rules:t.map((function(e,t){return{operator:r(t),variables:e}})).filter((function(e){return!!e.variables.length})),operator:p.length<=2?"":f[p.find((function(e){return"operate"===e.type})).val].value},[2,{err:n,data:l}]}}))}))}}})),c.default.createElement("div",{className:"con-nlp-ptr-condition-rel"},c.default.createElement("div",{className:"module-block"},p.map((function(e,t){return"operate"===e.type?c.default.createElement("div",{key:t,className:"module-tag"},c.default.createElement(u.Tooltip,{title:"规则之间是「"+f[e.val].label+"」关系"},c.default.createElement(u.Tag,{color:"blue"},f[e.val].label))):c.default.createElement(u.Card,{key:t,hoverable:!0,size:"small",title:"规则"+(Math.floor(t/2)+1),extra:c.default.createElement("a",{onClick:function(){return e=t,void u.Modal.confirm({title:"提示",content:"确定删除吗？",onOk:function(){var t=o(p);1===t.length?t=[]:(t.splice(e,1),t.splice(e-1,1)),m(t)}});var e}},"删除"),style:{width:"100%",margin:"15px 0"}},(e.children||[]).map((function(e,n){return"operate"===e.type?c.default.createElement(u.Divider,{dashed:!0},"and"===e.val?"并且":"或者"):c.default.createElement("div",{className:"condition-form"},c.default.createElement(u.Tooltip,{title:"删除此条件"},c.default.createElement("div",{className:"form-prefix",onClick:function(){return e=t,l=n,void u.Modal.confirm({title:"提示",content:"确定删除吗？",onOk:function(){var t=o(p),n=t[e].children||[];1===n.length?n=[]:(n.splice(l,1),n.splice(l-1,1)),t.splice(e,1,r(r({},t[e]),{children:n})),m(t)}});var e,l}},c.default.createElement(u.Icon,{type:"minus-circle"}))),c.default.createElement(s.NlpPtrCondition,{abilityId:i,wrappedComponentRef:y[t][n]}))})),c.default.createElement("div",{className:"condition-btns-block"},!!e.children&&(0===e.children.length||1===e.children.length||!!e.children.find((function(e){return"and"===e.val})))&&c.default.createElement(u.Tooltip,{title:"添加「并且」条件"},c.default.createElement(u.Button,{size:"small",type:"link",shape:"circle",onClick:function(){return v(t,"and")}},"&")),!!e.children&&(0===e.children.length||1===e.children.length||!!e.children.find((function(e){return"or"===e.val})))&&c.default.createElement(u.Tooltip,{title:"添加「或者」条件"},c.default.createElement(u.Button,{size:"small",type:"link",shape:"circle",onClick:function(){return v(t,"or")}},"||"))))}))),c.default.createElement("div",{className:"module-btns-block"},c.default.createElement(u.Button.Group,null,(0===p.length||1===p.length||!!p.find((function(e){return"and"===e.val})))&&c.default.createElement(u.Tooltip,{title:"添加规则"},c.default.createElement(u.Button,{icon:"plus",type:"primary",onClick:function(){return h("and")}},"并且")),(0===p.length||1===p.length||!!p.find((function(e){return"or"===e.val})))&&c.default.createElement(u.Tooltip,{title:"添加规则"},c.default.createElement(u.Button,{icon:"plus",type:"primary",onClick:function(){return h("or")}},"或者")))))}))},462:function(e,t,n){e.exports=n(463)},463:function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var l=r(n(0)),a=r(n(10)),o=n(470);n(914),a.render(l.createElement(o.App,null),document.getElementById("example"))},470:function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var l=n(21),a=r(n(0)),o=n(193),i=n(799),u=n(423),c=n(414);n(912);var s=l.Menu.SubMenu,f=l.Layout.Content,d=l.Layout.Sider;t.App=function(){var e=a.useState(!0),t=e[0],n=(e[1],a.useState([])),r=n[0],p=n[1],m=a.useMemo((function(){return[{title:"对话配置",icon:"bar-chart",url:"/base/entry"}]}),[]);return a.useEffect((function(){var e=window.location.pathname;if(e){var t=m.findIndex((function(t){return t.url.includes(e)}));p([String(t)])}}),[]),a.default.createElement(u.StoreProvider,null,a.default.createElement(o.BrowserRouter,null,a.default.createElement(l.Layout,{className:"p-base",style:{height:"100vh"}},a.default.createElement(c.AppHeader,{showUser:!1}),a.default.createElement(l.Layout,null,a.default.createElement(d,{width:t?200:0},a.default.createElement(l.Menu,{mode:"inline",selectedKeys:r,style:{height:"100%",borderRight:0},defaultOpenKeys:m.map((function(e){return e.title})),onClick:function(e){return p([e.key])}},m.map((function(e,t){return e.items?a.default.createElement(s,{key:e.title,title:a.default.createElement("span",null,a.default.createElement(l.Icon,{type:e.icon})," ",e.title)},e.items.map((function(e,n){return a.default.createElement(l.Menu.Item,{key:t+"-"+n},a.default.createElement(o.Link,{to:e.url},e.title))}))):a.default.createElement(l.Menu.Item,{key:t},a.default.createElement(o.Link,{to:e.url},a.default.createElement(l.Icon,{type:e.icon}),e.title))})))),a.default.createElement(l.Layout,{style:{padding:"0 24px 24px"}},a.default.createElement(f,{style:{margin:0,padding:24,background:"#fff"}},a.default.createElement(o.Switch,null,a.default.createElement(o.Route,{path:"/base",component:i.Base}),a.default.createElement(o.Redirect,{exact:!0,from:"/",to:"/base/entry"}))))))))}},530:function(e,t,n){var r={"./af":219,"./af.js":219,"./ar":220,"./ar-dz":221,"./ar-dz.js":221,"./ar-kw":222,"./ar-kw.js":222,"./ar-ly":223,"./ar-ly.js":223,"./ar-ma":224,"./ar-ma.js":224,"./ar-sa":225,"./ar-sa.js":225,"./ar-tn":226,"./ar-tn.js":226,"./ar.js":220,"./az":227,"./az.js":227,"./be":228,"./be.js":228,"./bg":229,"./bg.js":229,"./bm":230,"./bm.js":230,"./bn":231,"./bn.js":231,"./bo":232,"./bo.js":232,"./br":233,"./br.js":233,"./bs":234,"./bs.js":234,"./ca":235,"./ca.js":235,"./cs":236,"./cs.js":236,"./cv":237,"./cv.js":237,"./cy":238,"./cy.js":238,"./da":239,"./da.js":239,"./de":240,"./de-at":241,"./de-at.js":241,"./de-ch":242,"./de-ch.js":242,"./de.js":240,"./dv":243,"./dv.js":243,"./el":244,"./el.js":244,"./en-SG":245,"./en-SG.js":245,"./en-au":246,"./en-au.js":246,"./en-ca":247,"./en-ca.js":247,"./en-gb":248,"./en-gb.js":248,"./en-ie":249,"./en-ie.js":249,"./en-il":250,"./en-il.js":250,"./en-nz":251,"./en-nz.js":251,"./eo":252,"./eo.js":252,"./es":253,"./es-do":254,"./es-do.js":254,"./es-us":255,"./es-us.js":255,"./es.js":253,"./et":256,"./et.js":256,"./eu":257,"./eu.js":257,"./fa":258,"./fa.js":258,"./fi":259,"./fi.js":259,"./fo":260,"./fo.js":260,"./fr":261,"./fr-ca":262,"./fr-ca.js":262,"./fr-ch":263,"./fr-ch.js":263,"./fr.js":261,"./fy":264,"./fy.js":264,"./ga":265,"./ga.js":265,"./gd":266,"./gd.js":266,"./gl":267,"./gl.js":267,"./gom-latn":268,"./gom-latn.js":268,"./gu":269,"./gu.js":269,"./he":270,"./he.js":270,"./hi":271,"./hi.js":271,"./hr":272,"./hr.js":272,"./hu":273,"./hu.js":273,"./hy-am":274,"./hy-am.js":274,"./id":275,"./id.js":275,"./is":276,"./is.js":276,"./it":277,"./it-ch":278,"./it-ch.js":278,"./it.js":277,"./ja":279,"./ja.js":279,"./jv":280,"./jv.js":280,"./ka":281,"./ka.js":281,"./kk":282,"./kk.js":282,"./km":283,"./km.js":283,"./kn":284,"./kn.js":284,"./ko":285,"./ko.js":285,"./ku":286,"./ku.js":286,"./ky":287,"./ky.js":287,"./lb":288,"./lb.js":288,"./lo":289,"./lo.js":289,"./lt":290,"./lt.js":290,"./lv":291,"./lv.js":291,"./me":292,"./me.js":292,"./mi":293,"./mi.js":293,"./mk":294,"./mk.js":294,"./ml":295,"./ml.js":295,"./mn":296,"./mn.js":296,"./mr":297,"./mr.js":297,"./ms":298,"./ms-my":299,"./ms-my.js":299,"./ms.js":298,"./mt":300,"./mt.js":300,"./my":301,"./my.js":301,"./nb":302,"./nb.js":302,"./ne":303,"./ne.js":303,"./nl":304,"./nl-be":305,"./nl-be.js":305,"./nl.js":304,"./nn":306,"./nn.js":306,"./pa-in":307,"./pa-in.js":307,"./pl":308,"./pl.js":308,"./pt":309,"./pt-br":310,"./pt-br.js":310,"./pt.js":309,"./ro":311,"./ro.js":311,"./ru":312,"./ru.js":312,"./sd":313,"./sd.js":313,"./se":314,"./se.js":314,"./si":315,"./si.js":315,"./sk":316,"./sk.js":316,"./sl":317,"./sl.js":317,"./sq":318,"./sq.js":318,"./sr":319,"./sr-cyrl":320,"./sr-cyrl.js":320,"./sr.js":319,"./ss":321,"./ss.js":321,"./sv":322,"./sv.js":322,"./sw":323,"./sw.js":323,"./ta":324,"./ta.js":324,"./te":325,"./te.js":325,"./tet":326,"./tet.js":326,"./tg":327,"./tg.js":327,"./th":328,"./th.js":328,"./tl-ph":329,"./tl-ph.js":329,"./tlh":330,"./tlh.js":330,"./tr":331,"./tr.js":331,"./tzl":332,"./tzl.js":332,"./tzm":333,"./tzm-latn":334,"./tzm-latn.js":334,"./tzm.js":333,"./ug-cn":335,"./ug-cn.js":335,"./uk":336,"./uk.js":336,"./ur":337,"./ur.js":337,"./uz":338,"./uz-latn":339,"./uz-latn.js":339,"./uz.js":338,"./vi":340,"./vi.js":340,"./x-pseudo":341,"./x-pseudo.js":341,"./yo":342,"./yo.js":342,"./zh-cn":343,"./zh-cn.js":343,"./zh-hk":344,"./zh-hk.js":344,"./zh-tw":345,"./zh-tw.js":345};function l(e){var t=a(e);return n(t)}function a(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}l.keys=function(){return Object.keys(r)},l.resolve=a,e.exports=l,l.id=530},799:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=r(n(0)),a=n(193),o=n(800),i=n(911);t.Base=function(e){e.location;return l.default.createElement("div",{style:{height:"100%",overflowY:"scroll"}},l.default.createElement(a.Route,{path:"/base/entry",component:o.Entry}),l.default.createElement(a.Route,{path:"/base/test",component:i.TestPage}))}},800:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=r(n(0)),a=n(414);n(909),t.Entry=function(){return l.default.createElement("div",{className:"animated fadeIn p-base-entry"},l.default.createElement(a.NlpTopicTree,{abilityId:4}))}},801:function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var l=n(193),a=n(802),o=n(60),i=r(n(0)),u=n(21),c=n(423);n(827);var s={showUser:!0},f=u.Layout.Header,d=u.Menu.SubMenu;t.AppHeader=function(e){var t=(void 0===e?s:e).showUser,r=l.useHistory(),p=c.useStore().User,m=i.useState({}),h=m[0],v=m[1],y=function(){var e=window.location,t=e.host,n=e.protocol;return window.location.href=n+"//"+t+"/apis/common/ai-logout"},b=i.useMemo((function(){var e=[];return e.push({icon:"setting",title:"操作指引",items:[{title:"标注任务",url:"/base/entry"}]}),e}),[]);return i.useEffect((function(){t&&o.http.get({url:"/t-apis/user_info"}).then((function(e){var t=e.status,n=e.data;200===t&&(v(n),p.setAccount(n))}))}),[t]),a.useObserver((function(){return i.default.createElement(f,null,i.default.createElement("div",{className:"con-app-header"},i.default.createElement("div",{className:"content-block"},i.default.createElement("div",{className:"logo-block"},i.default.createElement("img",{className:"logo",src:n(829).default}),i.default.createElement("a",{className:"title"},"NLP技能管理")),i.default.createElement("div",{className:"menu-block"},i.default.createElement(u.Menu,{theme:"dark",mode:"horizontal"},b.map((function(e,t){return i.default.createElement(d,{key:t,title:i.default.createElement("span",{className:"submenu-title-wrapper"},!!e.icon&&i.default.createElement(u.Icon,{type:e.icon}),e.title)},(e.items||[]).map((function(e,t){return i.default.createElement(u.Menu.Item,{onClick:function(){return!!e.url&&r.push(e.url)},key:t},e.title)})))}))))),t&&i.default.createElement("div",{className:"user-block"},i.default.createElement(u.Dropdown,{overlay:i.default.createElement(u.Menu,null,i.default.createElement(u.Menu.Item,null,i.default.createElement("a",{onClick:y},"退出登陆 ",i.default.createElement(u.Icon,{type:"arrow-right"}))))},i.default.createElement(u.Avatar,{size:"large",style:{color:"#fff",backgroundColor:"#1890ff"}},h.username)))))}))}},825:function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var l,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(l=e[i])&&(o=(a<3?l(o):a>3?l(t,n,o):l(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},l=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var a=n(44),o=(n(826),function(){function e(){this.account={},this.taskRole=0}return e.prototype.setRole=function(e){console.log("当前任务权限："+e),this.taskRole=e},e.prototype.setAccount=function(e){this.account=e},r([a.observable,l("design:type",Object)],e.prototype,"account",void 0),r([a.observable,l("design:type",Number)],e.prototype,"taskRole",void 0),r([a.action,l("design:type",Function),l("design:paramtypes",[Number]),l("design:returntype",void 0)],e.prototype,"setRole",null),r([a.action,l("design:type",Function),l("design:paramtypes",[Object]),l("design:returntype",void 0)],e.prototype,"setAccount",null),e}());t.default=new o},826:function(e,t,n){"use strict";var r,l;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.user=0]="user",e[e.org=1]="org",e[e.custom=2]="custom"}(r||(r={})),t.EOrgUserType=r,function(e){e[e.noRole=0]="noRole",e[e.read=1]="read",e[e.label=2]="label",e[e.use=3]="use"}(l||(l={})),t.ETaskRole=l},827:function(e,t,n){var r=n(27),l=n(828);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);var a={insert:"head",singleton:!1},o=(r(e.i,l,a),l.locals?l.locals:{});e.exports=o},828:function(e,t,n){(t=n(28)(!1)).push([e.i,".con-app-header {\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n}\n.con-app-header .content-block {\n  display: flex;\n  align-items: center;\n}\n.con-app-header .content-block .logo-block {\n  display: flex;\n  align-items: flex-end;\n}\n.con-app-header .content-block .logo-block .logo {\n  height: 25px;\n  width: 80px;\n  margin-right: 10px;\n}\n.con-app-header .content-block .logo-block .title {\n  color: #fff;\n  font-size: 18px;\n  line-height: 18px;\n  display: inline-block;\n  letter-spacing: 0.05em;\n  margin-bottom: 2px;\n}\n.con-app-header .content-block .menu-block {\n  margin-left: 20px;\n}\n",""]),e.exports=t},829:function(e,t,n){"use strict";n.r(t),t.default="/dist/build/img/cvte.png"},888:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var l in t=arguments[n])Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l]);return e}).apply(this,arguments)},l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(l,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function i(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?l(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}u((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,l,a,o={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(a){return function(i){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(l=2&a[0]?r.return:a[0]?r.throw||((l=r.return)&&l.call(r),0):r.next)&&!(l=l.call(r,a[1])).done)return l;switch(r=0,l&&(a=[2&a[0],l.value]),a[0]){case 0:case 1:l=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(l=(l=o.trys).length>0&&l[l.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!l||a[1]>l[0]&&a[1]<l[3])){o.label=a[1];break}if(6===a[0]&&o.label<l[1]){o.label=l[1],l=a;break}if(l&&o.label<l[2]){o.label=l[2],o.ops.push(a);break}l[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=l=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,i])}}},o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var i=n(60),u=n(131),c=n(21),s=n(55),f=o(n(0)),d=n(112),p=n(191);n(891);var m=s.MyForm("nlp-ptr-slot-base"),h=s.MyForm("nlp-ptr-slot-detail"),v=s.MyForm("nlp-ptr-slot-clarify");t.NlpPtrSlot=f.default.forwardRef((function(e,t){var n=e.abilityId,o=void 0===n?"":n,y=f.useRef(null),b=f.useRef(null),g=f.useRef(null),_=f.useState({}),k=_[0],w=_[1],E=f.useState([]),j=E[0],x=E[1],P=f.useState(!1),O=P[0],S=P[1],M=f.useState({}),C=M[0],N=M[1],T=u.useFetch({url:"/t-apis/v1/nlp/skill/"+o}),I=T[0],D=T[1],R=u.useFetch({url:"/t-apis/v1/nlp/entity/"+o}),q=R[0],z=R[1],F=function(e){c.notification.info({description:e,message:"提示"})},A=f.useMemo((function(){return[{key:"skill_intent",label:"意图",type:"cascader",expandTrigger:"click",placeholder:"请选择意图",rules:[{required:!0,message:"请选择意图"}],options:(I.instances||[]).map((function(e){return{value:e.skill_id,label:e.skill_name,children:C[e.skill_id]?C[e.skill_id].map((function(e){return{value:e.intention_id,label:e.intention_name}})):[{label:" ",value:" "}]}}))},{key:"slot_name",label:"槽位名称",type:"input",placeholder:"请填写槽位名称",rules:[{required:!0,message:"请填写槽位名称"}]},{key:"alias_name",label:"别称",type:"input",placeholder:"请填写槽位别称",rules:[{required:!0,message:"请填写槽位别称"}]},{key:"required",label:"是否必填",type:"select",placeholder:"请选择是否必填",options:p.findDic("nlp.form.required"),rules:[{required:!0,message:"请选择是否必填"}]}]}),[I,C]),B=f.useMemo((function(){return[{key:"entity_id",label:"实体",type:"select",placeholder:"请选择实体",options:(q.instances||[]).map((function(e){return{label:e.entity_name,value:e.entity_id}})),rules:[{required:!0,message:"请选择实体"}]},{key:"field_name",label:"字段名称",type:"input",placeholder:"请填写字段名称",rules:[{required:!0,message:"请填写字段名称"}]},{key:"field_type",label:"字段类型",type:"select",placeholder:"请选择字段类型",options:p.findDic("nlp.form.fieldType"),rules:[{required:!0,message:"请选择是字段类型"}]}]}),[q]),H=f.useMemo((function(){return[{key:"say_mode",label:"返回方式",type:"select",placeholder:"请选择返回方式",options:p.findDic("nlp.form.sayMode"),rules:[{required:!0,message:"请选择返回方式"}]},{min:0,key:"clarify_times",label:"澄清次数",type:"number",placeholder:"请填写澄清次数",rules:[{required:!0,message:"请填写澄清次数"}]}]}),[]);return f.useImperativeHandle(t,(function(){return{getData:function(){return l(void 0,void 0,void 0,(function(){return a(this,(function(e){return[2,{type:"slot",context:k}]}))}))},open:function(){S(!0)}}})),f.useEffect((function(){z.load(""),D.load({params:{offset:0,length:9999}})}),[]),f.default.createElement("div",{className:"con-nlp-ptr-slot"},f.default.createElement(c.Card,{title:"词槽收集",style:{width:200},onClick:function(){return S(!0)}},"卡片内容"),f.default.createElement(c.Drawer,{width:450,title:"配置 - 词槽节点",visible:O,onClose:function(){return S(!1)}},f.default.createElement(d.PtrConfTitle,{title:"基本信息"}),f.default.createElement(m,{ref:y,onChange:function(e){var t=(e.skill_intent||[])[0]||"";String(t)&&!C[t]&&i.http.get({url:"/t-apis/v1/nlp/intention/"+o+"?skill_id"+t}).then((function(e){var n,l=e.status,a=e.data;200===l&&N(r(r({},C),((n={})[t]=a,n)))}))},formItems:A}),f.default.createElement(d.PtrConfTitle,{title:"上下文信息"}),f.default.createElement(h,{ref:b,formItems:B}),f.default.createElement(d.PtrConfTitle,{title:"澄清话术"}),f.default.createElement(s.MulInput,{label:"澄清话术：",onChane:x}),f.default.createElement(v,{ref:g,formItems:H}),f.default.createElement(c.Button,{block:!0,type:"primary",style:{marginTop:50},onClick:function(){return l(void 0,void 0,void 0,(function(){var e;return a(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(e){var t=y.current,n=b.current,l=g.current;t.validateFields((function(t,a){n.validateFields((function(n,o){l.validateFields((function(l,i){if(t||n||l)return F("请完善表单"),e(null);if(!j.length)return F("请完善话术"),e(null);var u=a.skill_intent,c=a.slot_name,s=a.alias_name,f=a.required,d=u[0],p=u[1];if(!p)return F("请选择意图"),e(null);e(r(r(r({},o),i),{skill_id:d,required:f,intent_id:p,slot_name:c,alias_name:s}))}))}))}))}))];case 1:return(e=t.sent())?(w(e),S(!1),[2]):[2]}}))}))}},"确定")))}))},889:function(e,t,n){var r=n(27),l=n(890);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);var a={insert:"head",singleton:!1},o=(r(e.i,l,a),l.locals?l.locals:{});e.exports=o},890:function(e,t,n){(t=n(28)(!1)).push([e.i,".com-ptr-conf-title {\n  color: #333;\n  margin: 20px 0;\n  font-size: 15px;\n  font-weight: 700;\n  padding-left: 15px;\n  letter-spacing: 0.1em;\n  position: relative;\n}\n.com-ptr-conf-title::after {\n  top: 0;\n  left: 0;\n  width: 4px;\n  content: '';\n  height: 100%;\n  position: absolute;\n  background: #1890ff;\n}\n",""]),e.exports=t},891:function(e,t,n){var r=n(27),l=n(892);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);var a={insert:"head",singleton:!1},o=(r(e.i,l,a),l.locals?l.locals:{});e.exports=o},892:function(e,t,n){(t=n(28)(!1)).push([e.i,"",""]),e.exports=t},893:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var l in t=arguments[n])Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l]);return e}).apply(this,arguments)},l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(l,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function i(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?l(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}u((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,l,a,o={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(a){return function(i){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(l=2&a[0]?r.return:a[0]?r.throw||((l=r.return)&&l.call(r),0):r.next)&&!(l=l.call(r,a[1])).done)return l;switch(r=0,l&&(a=[2&a[0],l.value]),a[0]){case 0:case 1:l=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(l=(l=o.trys).length>0&&l[l.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!l||a[1]>l[0]&&a[1]<l[3])){o.label=a[1];break}if(6===a[0]&&o.label<l[1]){o.label=l[1],l=a;break}if(l&&o.label<l[2]){o.label=l[2],o.ops.push(a);break}l[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=l=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,i])}}},o=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),l=0;for(t=0;t<n;t++)for(var a=arguments[t],o=0,i=a.length;o<i;o++,l++)r[l]=a[o];return r},i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var u=n(21),c=n(55),s=i(n(0)),f=n(112),d=n(894),p=c.MyForm("nlp-ptr-slot-base");t.NlpPtrFetch=s.default.forwardRef((function(e,t){var n=e.abilityId,i=s.useRef(null),m=s.useState({}),h=m[0],v=m[1],y=s.useState({"":""}),b=y[0],g=y[1],_=s.useState([s.createRef()]),k=_[0],w=_[1],E=s.useState(!1),j=E[0],x=E[1],P=function(){return new Promise((function(e){i.current.validateFields((function(t,n){Promise.all(k.map((function(e){return e.current.getData()}))).then((function(l){if(t||l.some((function(e){return!e})))return a="请完善表单",u.notification.info({description:a,message:"提示"}),e(null);var a;e(r(r({},n),{in_params:l,out_params:Object.entries(b).map((function(e){return{name:e[0],value:e[1]}}))}))}))}))}))},O=s.useMemo((function(){return[{key:"url",label:"请求地址",type:"input",placeholder:"请填写请求地址",rules:[{required:!0,message:"请填写请求地址"}]},{key:"request_method",label:"请求方法",type:"select",placeholder:"请选择请求方法",options:[{label:"GET",value:"GET"},{label:"POST",value:"POST"}],rules:[{required:!0,message:"请选择请求方法"}]},,{key:"protocol",label:"协议",type:"select",placeholder:"请选择协议",options:[{label:"http",value:"http"},{label:"https",value:"https"}],rules:[{required:!0,message:"请选择请协议"}]},{key:"error_return",label:"异常处理",type:"input",placeholder:"如：查询出错，请联系工作人员",rules:[{required:!0,message:"请填写异常处理"}]}]}),[]);return s.useImperativeHandle(t,(function(){return{getData:function(){return l(void 0,void 0,void 0,(function(){return a(this,(function(e){return[2,{type:"resource",info:h}]}))}))},open:function(){x(!0)}}})),s.default.createElement("div",{className:"con-nlp-ptr-fetch"},s.default.createElement(u.Card,{title:"资源调用",style:{width:200},onClick:function(){return x(!0)}},"卡片内容"),s.default.createElement(u.Drawer,{width:450,title:"配置 - 资源调用",visible:j,onClose:function(){return x(!1)}},s.default.createElement(f.PtrConfTitle,{title:"基本信息"}),s.default.createElement(p,{ref:i,formItems:O}),s.default.createElement(f.PtrConfTitle,{title:"传入参数"}),k.map((function(e,t){return s.default.createElement(u.Card,{key:t,style:{margin:12},title:"参数-"+(t+1),extra:s.default.createElement("a",{onClick:function(){return e=t,(n=o(k)).splice(e,1),void w(n);var e,n}},"删除")},s.default.createElement(d.NlpPtrFetchParams,{abilityId:n,wrappedComponentRef:e}))})),s.default.createElement("div",null,s.default.createElement(u.Tooltip,{title:"添加传入参数"},s.default.createElement(u.Button,{icon:"plus",size:"small",type:"primary",shape:"circle",style:{margin:10},onClick:function(){w(o(k,[s.createRef()]))}}))),s.default.createElement(f.PtrConfTitle,{title:"返回配置"}),s.default.createElement(c.MulvalueActiveForm,{json:b,onChane:g,placeholder:{key:"字段名称",value:"返回参数如：man.x.y"}}),s.default.createElement(u.Button,{block:!0,type:"primary",onClick:function(){return l(void 0,void 0,void 0,(function(){var e;return a(this,(function(t){switch(t.label){case 0:return[4,P()];case 1:return(e=t.sent())?(v(e),x(!1),[2]):[2]}}))}))},style:{marginTop:50}},"确定")))}))},894:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var l in t=arguments[n])Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l]);return e}).apply(this,arguments)},l=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var a=n(60),o=n(131),i=n(21),u=l(n(0)),c=n(191),s=i.Select.Option;t.NlpPtrFetchParams=i.Form.create({name:String(Date.now())})(u.default.forwardRef((function(e,t){var n=e.form,l=e.abilityId,f=void 0===l?"":l,d=u.useState(""),p=d[0],m=d[1],h=u.useState({}),v=h[0],y=h[1],b=u.useState({}),g=b[0],_=b[1],k=o.useFetch({url:"/t-apis/v1/nlp/skill/"+f}),w=k[0],E=k[1],j=function(e){var t=x[e];return u.default.createElement(i.Row,{gutter:16},u.default.createElement(i.Col,{span:6,style:{lineHeight:"30px"}},t.label),t.forms.map((function(e,l){return u.default.createElement(i.Col,{key:l,span:3===t.forms.length?6:2===t.forms.length?9:18},u.default.createElement(i.Form.Item,null,n.getFieldDecorator(e.key,{rules:e.rules||[],valuePropName:"value"})("input"===e.type?u.default.createElement(i.Input,{placeholder:e.placeholder}):"select"===e.type?u.default.createElement(i.Select,{onChange:function(t){return n=e.key,r=t,void("type"===n&&m(r));var n,r},placeholder:e.placeholder},e.options.map((function(e,t){return u.default.createElement(s,{key:t,value:e.value},e.label)}))):"cascader"===e.type?u.default.createElement(i.Cascader,{changeOnSelect:!0,options:e.options,expandTrigger:"click",placeholder:e.placeholder,onChange:function(t){return function(e,t){if("value"===e){var n=(t||[])[0]||"",l=(t||[])[1]||"";t[1]||null===n||v[n]?t[2]||null===l||g[l]||a.http.get({url:"/t-apis/v1/nlp/intention/"+f+"/"+l}).then((function(e){var t,n=e.status,a=e.data;200===n&&_(r(r({},g),((t={})[l]=(a.slots||[]).map((function(e){return{value:e.slot_id,label:e.slot_name}})),t)))})):a.http.get({url:"/t-apis/v1/nlp/intention/"+f+"?skill_id"+n}).then((function(e){var t,l=e.status,a=e.data;200===l&&y(r(r({},v),((t={})[n]=(a||[]).map((function(e){return{value:e.intention_id,label:e.intention_name}})),t)))}))}}(e.key,t)}}):null)))})))},x=u.useMemo((function(){var e=[{label:" ",value:""}],t=(w.instances||[]).map((function(t){return{value:t.skill_id,label:t.skill_name,children:v[t.skill_id]?v[t.skill_id].map((function(t){return r(r({},t),{children:g[t.value]?g[t.value]:e})})):e}}));return{base:{label:"字段信息:",forms:[{key:"name",type:"input",placeholder:"请填写字段名称",rules:[{required:!0,message:"请填写字段名称"}]},{key:"type",type:"select",placeholder:"请选择参数位置",options:c.findDic("nlp.form.paramType"),rules:[{required:!0,message:"请选择请选择参数位置"}]}]},pos:{label:"字段位置:",forms:[{key:"pos",type:"select",placeholder:"请选择参数位置",options:c.findDic("nlp.form.paramPos"),rules:[{required:!0,message:"请选择请选择参数位置"}]}]},"val-custom":{label:"自定义:",forms:[{key:"value",type:"input",placeholder:"请填写字段的值",rules:[{required:!0,message:"请填写字段的值"}]}]},"val-slot":{label:"槽位:",forms:[{key:"value",label:"意图",type:"cascader",placeholder:"请选择词槽",rules:[{required:!0,message:"请选择词槽"}],options:t}]}}}),[w,v,g]);return u.useImperativeHandle(t,(function(){return{getData:function(){return new Promise((function(e){n.validateFields((function(t,n){if(t)return e(null);e(r(r({},n),{value:"custom"===p?n.value:"$"+n.value.join(".")}))}))}))}}})),u.useEffect((function(){E.load({params:{offset:0,length:9999}})}),[]),u.default.createElement("div",null,u.default.createElement(i.Form,null,j("base"),j("pos"),!!p&&j("val-"+p)))})))},895:function(e,t,n){var r=n(27),l=n(896);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);var a={insert:"head",singleton:!1},o=(r(e.i,l,a),l.locals?l.locals:{});e.exports=o},896:function(e,t,n){(t=n(28)(!1)).push([e.i,".con-nlp-ptr-custom-answer .opt-block {\n  margin-bottom: 30px;\n}\n.con-nlp-ptr-custom-answer .pause-block {\n  display: flex;\n  align-items: center;\n}\n",""]),e.exports=t},897:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var l in t=arguments[n])Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l]);return e}).apply(this,arguments)},l=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var a=n(60),o=n(131),i=n(21),u=l(n(0)),c=n(191),s=i.Select.Option;t.NlpPtrCondition=i.Form.create({name:String(Date.now())})(u.default.forwardRef((function(e,t){var n=e.form,l=e.abilityId,f=void 0===l?"":l,d=u.useState(""),p=d[0],m=d[1],h=u.useState({}),v=h[0],y=h[1],b=u.useState({}),g=b[0],_=b[1],k=o.useFetch({url:"/t-apis/v1/nlp/skill/"+f}),w=k[0],E=k[1],j=function(){setTimeout((function(){var e=n.getFieldsValue().range;m("if-"+e)}),0)},x=function(e){var t=P[e];return u.default.createElement(i.Row,{gutter:16,style:{marginBottom:15}},u.default.createElement(i.Col,{span:6,style:{lineHeight:"30px"}},t.label),t.forms.map((function(e,l){return u.default.createElement(i.Col,{key:l,span:3===t.forms.length?6:2===t.forms.length?9:18},u.default.createElement(i.Form.Item,null,n.getFieldDecorator(e.key,{rules:e.rules||[],valuePropName:"value"})("input"===e.type?u.default.createElement(i.Input,{onChange:j,placeholder:e.placeholder}):"select"===e.type?u.default.createElement(i.Select,{onChange:j,placeholder:e.placeholder},e.options.map((function(e,t){return u.default.createElement(s,{key:t,value:e.value},e.label)}))):"cascader"===e.type?u.default.createElement(i.Cascader,{changeOnSelect:!0,expandTrigger:"click",options:e.options,placeholder:e.placeholder,onChange:function(t){return function(e,t){if("slot"===e||"intent"===e){var n=(t||[])[0]||"",l=(t||[])[1]||"";t[1]||null===n||v[n]?"if-slot"!==p||t[2]||null===l||g[l]||a.http.get({url:"/t-apis/v1/nlp/intention/"+f+"/"+l}).then((function(e){var t,n=e.status,a=e.data;200===n&&_(r(r({},g),((t={})[l]=(a.slots||[]).map((function(e){return{value:e.slot_id,label:e.slot_name}})),t)))})):a.http.get({url:"/t-apis/v1/nlp/intention/"+f+"?skill_id"+n}).then((function(e){var t,l=e.status,a=e.data;200===l&&y(r(r({},v),((t={})[n]=(a||[]).map((function(e){return{value:e.intention_id,label:e.intention_name}})),t)))}))}}(e.key,t)}}):null)))})))},P=u.useMemo((function(){var e=[{label:" ",value:""}],t=(w.instances||[]).map((function(t){return{value:t.skill_id,label:t.skill_name,children:v[t.skill_id]?v[t.skill_id].map((function(t){return r(r({},t),{children:g[t.value]?g[t.value]:"if-slot"===p?e:null})})):e}}));return{range:{label:"比较范围:",forms:[{key:"range",type:"select",placeholder:"请选择范围",options:c.findDic("nlp.compareRange"),rules:[{required:!0,message:"请选择范围"}]}]},content:{label:"内容:",forms:[{key:"content",type:"input",placeholder:"请填写内容",rules:[{required:!0,message:"请填写内容"}]}]},"if-input":{label:"如果:",forms:[{key:"type",type:"select",options:c.findDic("nlp.if.input"),rules:[{required:!0,message:"请选择类型"}]},{key:"operator",type:"select",options:c.findDic("nlp.operator.input"),rules:[{required:!0,message:"请选择比较"}]}]},"if-intent":{label:"如果:",forms:[{key:"intent",type:"cascader",placeholder:"请选择意图",options:t},{key:"operator",type:"select",placeholder:"请选择比较",options:c.findDic("nlp.operator.intent"),rules:[{required:!0,message:"请选择比较"}]}]},"if-slot":{label:"如果:",forms:[{key:"slot",type:"cascader",placeholder:"请选择槽位",options:t},{key:"operator",type:"select",placeholder:"请选择比较",options:c.findDic("nlp.operator.slot"),rules:[{required:!0,message:"请选择比较"}]}]},"if-variable":{label:"如果:",forms:[{key:"variable",type:"input",placeholder:"请填写变量名",rules:[{required:!0,message:"请填写变量名"}]},{key:"operator",type:"select",placeholder:"请选择比较",options:c.findDic("nlp.operator.variable"),rules:[{required:!0,message:"请选择比较"}]}]}}}),[w,v,g,p]);return u.useImperativeHandle(t,(function(){return{getData:function(){return new Promise((function(e){n.validateFields((function(t,n){e({err:t,data:r({},n)})}))}))}}})),u.useEffect((function(){E.load({params:{offset:0,length:9999}})}),[]),u.default.createElement(i.Form,null,x("range"),!!p&&x(p),!!p&&x("content"))})))},898:function(e,t,n){var r=n(27),l=n(899);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);var a={insert:"head",singleton:!1},o=(r(e.i,l,a),l.locals?l.locals:{});e.exports=o},899:function(e,t,n){(t=n(28)(!1)).push([e.i,".con-nlp-ptr-condition-rel .module-block .module-tag {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.con-nlp-ptr-condition-rel .module-block .condition-form {\n  padding-left: 10px;\n  position: relative;\n}\n.con-nlp-ptr-condition-rel .module-block .condition-form .form-prefix {\n  top: 6px;\n  left: -6px;\n  font-size: 12px;\n  color: #ff4d4f;\n  position: absolute;\n}\n.con-nlp-ptr-condition-rel .module-block .condition-btns-block {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.con-nlp-ptr-condition-rel .module-btns-block {\n  display: flex;\n  margin: 18px 0 0 0 ;\n  justify-content: center;\n}\n",""]),e.exports=t},900:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var l in t=arguments[n])Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l]);return e}).apply(this,arguments)},l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(l,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function i(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?l(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}u((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,l,a,o={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(a){return function(i){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(l=2&a[0]?r.return:a[0]?r.throw||((l=r.return)&&l.call(r),0):r.next)&&!(l=l.call(r,a[1])).done)return l;switch(r=0,l&&(a=[2&a[0],l.value]),a[0]){case 0:case 1:l=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(l=(l=o.trys).length>0&&l[l.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!l||a[1]>l[0]&&a[1]<l[3])){o.label=a[1];break}if(6===a[0]&&o.label<l[1]){o.label=l[1],l=a;break}if(l&&o.label<l[2]){o.label=l[2],o.ops.push(a);break}l[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=l=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,i])}}},o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var i=n(21),u=o(n(0)),c=n(112),s=n(192),f=n(437);t.NlpPtrRes=u.default.forwardRef((function(e,t){var n=e.abilityId,o=void 0===n?"":n,d=u.useRef(null),p=u.useRef(null),m=u.useState(!1),h=m[0],v=m[1],y=u.useState({}),b=y[0],g=y[1];return u.useImperativeHandle(t,(function(){return{getData:function(){return l(void 0,void 0,void 0,(function(){return a(this,(function(e){return[2,r({type:"response_condition"},b)]}))}))},open:function(){v(!0)}}})),u.default.createElement("div",{className:"con-nlp-ptr-fetch"},u.default.createElement(i.Card,{title:"回复",style:{width:200},onClick:function(){return v(!0)}},"卡片内容"),u.default.createElement(i.Drawer,{width:450,title:"配置 - 回复",visible:h,onClose:function(){return v(!1)}},u.default.createElement(c.PtrConfTitle,{title:"规则配置"}),u.default.createElement(f.NlpPtrConditionRel,{ref:d,abilityId:o}),u.default.createElement(c.PtrConfTitle,{title:"默认回复"}),u.default.createElement(s.PtrCustomAnswer,{label:"默认回复：",ref:p,types:["text","rich_text","image","option"]}),u.default.createElement(i.Button,{block:!0,type:"primary",onClick:function(){return l(void 0,void 0,void 0,(function(){var e;return a(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(e){var t=d.current,n=p.current;t.getData().then((function(t){n.getData().then((function(n){var r=t.err,l=n.err,a=t.data,o=n.data;if(r||l)return i.notification.info({message:"提示",description:"请完善表单"}),e(null);e({output:o,conditions:a})}))}))}))];case 1:return(e=t.sent())?(g(e),v(!1),[2]):[2]}}))}))},style:{marginTop:50}},"确定")))}))},901:function(e,t,n){var r=n(27),l=n(902);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);var a={insert:"head",singleton:!1},o=(r(e.i,l,a),l.locals?l.locals:{});e.exports=o},902:function(e,t,n){(t=n(28)(!1)).push([e.i,".com-nlp-process-ctrl {\n  display: flex;\n  align-items: center;\n  padding-left: 20px;\n}\n.com-nlp-process-ctrl .ball {\n  width: 10px;\n  height: 10px;\n  margin-right: 10px;\n  border-radius: 50%;\n  background: #d3adf7;\n}\n.com-nlp-process-ctrl .ball.purple {\n  background: #ffadd2;\n}\n.com-nlp-process-ctrl .ball.blue {\n  background: #91d5ff;\n}\n.com-nlp-process-ctrl .ball.cyan {\n  background: #87e8de;\n}\n",""]),e.exports=t},903:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var l in t=arguments[n])Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l]);return e}).apply(this,arguments)},l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(l,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function i(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?l(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}u((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,l,a,o={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(a){return function(i){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(l=2&a[0]?r.return:a[0]?r.throw||((l=r.return)&&l.call(r),0):r.next)&&!(l=l.call(r,a[1])).done)return l;switch(r=0,l&&(a=[2&a[0],l.value]),a[0]){case 0:case 1:l=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(l=(l=o.trys).length>0&&l[l.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!l||a[1]>l[0]&&a[1]<l[3])){o.label=a[1];break}if(6===a[0]&&o.label<l[1]){o.label=l[1],l=a;break}if(l&&o.label<l[2]){o.label=l[2],o.ops.push(a);break}l[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=l=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,i])}}},o=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),l=0;for(t=0;t<n;t++)for(var a=arguments[t],o=0,i=a.length;o<i;o++,l++)r[l]=a[o];return r},i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var u=n(904),c=n(60),s=i(n(0)),f=n(21),d=n(424),p=n(112),m=n(192);n(907);var h,v,y=f.Tree.TreeNode,b=f.Button.Group;t.NlpTopicTree=function(e){var t=e.abilityId,n=void 0===t?"":t,i=s.useRef(null),g=s.useState(null),_=g[0],k=g[1],w=s.useState(""),E=w[0],j=w[1],x=s.useState(null),P=x[0],O=x[1],S=s.useState({}),M=S[0],C=(S[1],s.useState([])),N=C[0],T=C[1],I=s.useState(!1),D=I[0],R=I[1],q=s.useState(!1),z=q[0],F=q[1],A=s.useState(!1),B=A[0],H=A[1],G=s.useState({}),L=(G[0],G[1]),U=function(e,t,n,l){void 0===t&&(t="欢迎"),void 0===n&&(n="");var a={parent:n,node_name:t,node_type:e,created:Date.now(),updated:Date.now(),node_id:e+"_"+u.v4()};return l&&(a=r(r({},a),{previous_sibling:l})),a},J=function(e){return e.map((function(e){return s.default.createElement(y,{key:e.node_id,icon:s.default.createElement(f.Icon,{type:"unordered-list"}),title:s.default.createElement(f.Popover,{content:s.default.createElement(b,null,e.node_type!==h.start&&s.default.createElement(f.Tooltip,{title:"创建兄弟话题"},s.default.createElement(f.Button,{size:"small",icon:"minus",type:"primary",onClick:function(t){return K(t,e,v.sibling)}})),s.default.createElement(f.Tooltip,{title:"创建子话题"},s.default.createElement(f.Button,{size:"small",type:"primary",icon:"align-center",onClick:function(t){return K(t,e,v.child)}})),e.node_type!==h.start&&s.default.createElement(f.Tooltip,{title:"重命名"},s.default.createElement(f.Button,{size:"small",icon:"edit",type:"primary",onClick:function(t){return V(t,e)}})),e.node_type!==h.start&&s.default.createElement(f.Tooltip,{title:"删除话题"},s.default.createElement(f.Button,{size:"small",icon:"close",type:"danger",onClick:function(t){return Y(t,e)}})))},e.node_name)},J(e.children||[]))}))},K=function(e,t,n){e.stopPropagation(),k(n),F(!0),O(t)},V=function(e,t){e.stopPropagation(),O(t),H(!0),j(t.node_name)},Y=function(e,t){if(e.stopPropagation(),Array.isArray(t.children)&&t.children.length>1)return f.notification.info({message:"提示",description:"请先删除子话题"});f.Modal.confirm({title:"提示",content:"删除该话题吗？",onOk:function(){var e=o(N),n=t.parent,l=N.filter((function(e){return e.parent===n})),a=l.find((function(e){return e.node_id===t.previous_sibling})),i=l.find((function(e){return e.previous_sibling===t.node_id})),u=N.findIndex((function(e){return e.node_id===t.node_id}));if(i)if(t.previous_sibling){if(a){c=N.findIndex((function(e){return e.node_id===i.node_id}));e.splice(c,1,r(r({},N[c]),{previous_sibling:a.node_id}))}}else{var c=N.findIndex((function(e){return e.node_id===i.node_id}));e.splice(c,1,r(r({},N[c]),{previous_sibling:void 0}))}else;e.splice(u,1),T(e)}})},$=s.useMemo((function(){var e=N.find((function(e){return e.node_type===h.start})),t=e?[e]:[],n=function(e){e.map((function(e){var t=function(e){if(!e)return[];var t=[e],n=function(e){var r=N.find((function(t){return t.previous_sibling===e.node_id}));r&&(t.push(r),n(r))};return n(t[0]),t}(N.find((function(t){return t.parent===e.node_id&&!t.previous_sibling})));e.children=t,n(t)}))};return n(t),t}),[N]);s.useMemo((function(){var e=!1,t=M.flow_config;try{JSON.parse(t)}catch(n){t&&f.notification.error({message:"提示",description:"数据解析错误"}),e=!0}return e}),[M]);return s.useEffect((function(){z||(j(""),k(null),O(null))}),[z]),s.useEffect((function(){B||(j(""),O(null))}),[B]),s.useEffect((function(){c.http.get({url:"/t-apis/v1/nlp/version/"+n+"/dev"}).then((function(e){var t=e.status,n=e.data;if(200===t){var r=n.flow_config,l=[];try{l=JSON.parse(r).nodes}catch(e){}!l.find((function(e){return e.type===h.start}))&&l.unshift(U(h.start)),T(l)}}))}),[]),s.default.createElement("div",{className:"con-nlp-topic-tree"},s.default.createElement("div",{className:"container"},s.default.createElement("div",{className:"tree-con"},s.default.createElement(f.Button,{block:!0,ghost:!0,size:"default",type:"primary",icon:"arrow-up",style:{marginBottom:20},onClick:function(){}},"保存"),s.default.createElement(f.Tree,{showIcon:!0,defaultExpandAll:!0,selectedKeys:[],onSelect:function(e){var t=N.find((function(t){return t.node_id===e[0]}));if(t)return t.node_type===h.start?R(!0):void 0}},J($))),s.default.createElement("div",{className:"content-con"},s.default.createElement("div",{className:"process-con"},s.default.createElement(d.NlpProcess,{abilityId:4})))),s.default.createElement(f.Drawer,{width:450,title:"配置 - 回复",visible:D,onClose:function(){return R(!1)}},s.default.createElement(p.PtrConfTitle,{title:"默认回复"}),s.default.createElement(m.PtrCustomAnswer,{label:"默认回复：",ref:i,types:["text","rich_text","image","option"]}),s.default.createElement(f.Button,{block:!0,type:"primary",onClick:function(){return l(void 0,void 0,void 0,(function(){var e;return a(this,(function(t){switch(t.label){case 0:return[4,new Promise((function(e){i.current.getData().then((function(t){var n=t.err,r=t.data;if(n)return f.notification.info({message:"提示",description:"请完善表单"}),e(null);e({output:r})}))}))];case 1:return(e=t.sent())?(L(e),R(!1),[2]):[2]}}))}))},style:{marginTop:50}},"确定")),s.default.createElement(f.Modal,{title:"话题名称",onOk:function(){if(""===E)return f.notification.info({message:"提示",description:"节点名称不能为空"});if(P){var e=_===v.sibling?P.parent:P.node_id,t=N.filter((function(t){return t.parent===e})),n=t.length>0?t[t.length-1].node_id:"";T(o(N,[U(h.frame,E,_===v.sibling?P.parent:P.node_id,n)])),F(!1)}},visible:z,onCancel:function(){return F(!1)}},s.default.createElement(f.Input,{value:E,placeholder:"请输入话题名称",onChange:function(e){return j(e.target.value)}})),s.default.createElement(f.Modal,{title:"编辑话题名称",onOk:function(){if(""===E)return f.notification.info({message:"提示",description:"节点名称不能为空"});if(P){var e=N.findIndex((function(e){return e.node_id===P.node_id})),t=o(N);t.splice(e,1,r(r({},N[e]),{node_name:E})),T(t),H(!1)}},visible:B,onCancel:function(){return H(!1)}},s.default.createElement(f.Input,{value:E,placeholder:"请输入话题名称",onChange:function(e){return j(e.target.value)}})))},function(e){e.start="start",e.frame="frame"}(h||(h={})),function(e){e[e.child=0]="child",e[e.sibling=1]="sibling"}(v||(v={}))},907:function(e,t,n){var r=n(27),l=n(908);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);var a={insert:"head",singleton:!1},o=(r(e.i,l,a),l.locals?l.locals:{});e.exports=o},908:function(e,t,n){(t=n(28)(!1)).push([e.i,".con-nlp-topic-tree .container {\n  display: flex;\n  height: 100%;\n}\n.con-nlp-topic-tree .container .tree-con {\n  min-width: 150px;\n  padding-right: 20px;\n  box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.15);\n}\n.con-nlp-topic-tree .container .content-con {\n  flex: 1;\n}\n.con-nlp-topic-tree .container .content-con .process-con {\n  padding-left: 50px;\n}\n",""]),e.exports=t},909:function(e,t,n){var r=n(27),l=n(910);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);var a={insert:"head",singleton:!1},o=(r(e.i,l,a),l.locals?l.locals:{});e.exports=o},910:function(e,t,n){(t=n(28)(!1)).push([e.i,".p-base-entry {\n  height: 100%;\n  position: relative;\n}\n",""]),e.exports=t},911:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=r(n(0));t.TestPage=function(){return l.default.createElement("div",null,"t")}},912:function(e,t,n){var r=n(27),l=n(913);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);var a={insert:"head",singleton:!1},o=(r(e.i,l,a),l.locals?l.locals:{});e.exports=o},913:function(e,t,n){(t=n(28)(!1)).push([e.i,"iframe {\n  border: none;\n}\n.ant-card {\n  overflow: hidden;\n}\n.ant-tag {\n  cursor: pointer !important;\n}\n.ant-card-meta-title,\n.ant-card-meta-title div,\n.ant-checkbox-wrapper,\n.ant-card-meta-description {\n  width: 100%;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n.ant-badge {\n  width: 100%;\n}\n",""]),e.exports=t}});